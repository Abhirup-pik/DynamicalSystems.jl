



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A Julia software library for the exploration of chaos and nonlinear dynamics.">
      
      
      
        <meta name="author" content="George Datseris">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.9.4">
    
    
      
        <title>Spatio-Temporal Examples - DynamicalSystems.jl</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#7e57c2">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../assets\Documenter.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-purple" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#spatio-temporal-prediction-examples" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="DynamicalSystems.jl" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                DynamicalSystems.jl
              </span>
              <span class="md-header-nav__topic">
                Spatio-Temporal Examples
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="DynamicalSystems.jl" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    DynamicalSystems.jl
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Fundamentals
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Fundamentals
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../definition/general/" title="Dynamical Systems" class="md-nav__link">
      Dynamical Systems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../definition/evolve/" title="Time Evolution" class="md-nav__link">
      Time Evolution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../definition/dataset/" title="Numerical Data" class="md-nav__link">
      Numerical Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../definition/reconstruction/" title="Delay Coordinates" class="md-nav__link">
      Delay Coordinates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../definition/predefined/" title="Predefined Systems" class="md-nav__link">
      Predefined Systems
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      ChaosTools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        ChaosTools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/overview/" title="Features Overview" class="md-nav__link">
      Features Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/orbitdiagram/" title="Orbit Diagrams & PSOS" class="md-nav__link">
      Orbit Diagrams & PSOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/lyapunovs/" title="Lyapunov Exponents" class="md-nav__link">
      Lyapunov Exponents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/entropies/" title="Entropies and Dimensions" class="md-nav__link">
      Entropies and Dimensions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/nlts/" title="Nonlinear Timeseries Analysis" class="md-nav__link">
      Nonlinear Timeseries Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/periodicity/" title="Periodicity" class="md-nav__link">
      Periodicity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chaos/chaos_detection/" title="Chaos Detection" class="md-nav__link">
      Chaos Detection
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      TimeseriesPrediction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        TimeseriesPrediction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tsintro/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../localmodels/" title="Local Modeling & Timeseries Prediction" class="md-nav__link">
      Local Modeling & Timeseries Prediction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spatiotemporal/" title="Spatio-Temporal Prediction" class="md-nav__link">
      Spatio-Temporal Prediction
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Spatio-Temporal Examples
      </label>
    
    <a href="./" title="Spatio-Temporal Examples" class="md-nav__link md-nav__link--active">
      Spatio-Temporal Examples
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#temporal-prediction-kuramoto-sivashinsky" title="Temporal Prediction: Kuramoto-Sivashinsky" class="md-nav__link">
    Temporal Prediction: Kuramoto-Sivashinsky
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#produce-field-u-kuramoto-sivashinsky" title="Produce field U (Kuramoto Sivashinsky)" class="md-nav__link">
    Produce field U (Kuramoto Sivashinsky)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot-the-result" title="Plot the result" class="md-nav__link">
    Plot the result
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cross-prediction-barkley-model" title="Cross Prediction: Barkley Model" class="md-nav__link">
    Cross Prediction: Barkley Model
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simulate-a-test-system" title="Simulate a test system" class="md-nav__link">
    Simulate a test system
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot-prediction" title="Plot prediction" class="md-nav__link">
    Plot prediction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#temporal-prediction-of-field-u" title="Temporal prediction of field U" class="md-nav__link">
    Temporal prediction of field U
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../advanced/" title="Advanced Documentation" class="md-nav__link">
      Advanced Documentation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../contributors_guide/" title="Contributor Guide" class="md-nav__link">
      Contributor Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../news/" title="News" class="md-nav__link">
      News
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#temporal-prediction-kuramoto-sivashinsky" title="Temporal Prediction: Kuramoto-Sivashinsky" class="md-nav__link">
    Temporal Prediction: Kuramoto-Sivashinsky
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#produce-field-u-kuramoto-sivashinsky" title="Produce field U (Kuramoto Sivashinsky)" class="md-nav__link">
    Produce field U (Kuramoto Sivashinsky)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot-the-result" title="Plot the result" class="md-nav__link">
    Plot the result
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cross-prediction-barkley-model" title="Cross Prediction: Barkley Model" class="md-nav__link">
    Cross Prediction: Barkley Model
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simulate-a-test-system" title="Simulate a test system" class="md-nav__link">
    Simulate a test system
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot-prediction" title="Plot prediction" class="md-nav__link">
    Plot prediction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#temporal-prediction-of-field-u" title="Temporal prediction of field U" class="md-nav__link">
    Temporal prediction of field U
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl/edit/master/docs/tsprediction/stexamples.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <p><a id='Spatio-Temporal-Prediction-Examples-1'></a></p>
<h1 id="spatio-temporal-prediction-examples">Spatio-Temporal Prediction Examples</h1>
<p>In this page we are simply running files from the <code>examples</code> folder of the <code>TimeseriesPrediction</code> package.</p>
<p>This is how you can (programmatically) find this folder:</p>
<div class="codehilite"><pre><span></span><span class="k">using</span> <span class="n">TimeseriesPrediction</span>
<span class="n">exdir</span> <span class="o">=</span> <span class="n">dirname</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="n">pathof</span><span class="p">(</span><span class="n">TimeseriesPrediction</span><span class="p">)))</span><span class="o">*</span><span class="s">&quot;/examples&quot;</span>
</pre></div>


<p><a id='Temporal-Prediction:-Kuramoto-Sivashinsky-1'></a></p>
<h2 id="temporal-prediction-kuramoto-sivashinsky">Temporal Prediction: Kuramoto-Sivashinsky</h2>
<p><em>(this requires <code>FFTW</code> to be installed)</em></p>
<p>This example predicts the temporal evolution of a one-dimensional field U, along with a time vector T, which has to be represented as vectors of vectors. Where the field comes from does not matter, but to make the example runnable we load one of the test systems of <code>TimeseriesPrediction</code>.</p>
<p>In this example we use the solution of Kuramoto Sivashinsky equation.</p>
<p>Importantly, the results are compared with the "real" evolution of the system.</p>
<p>In the plots, the x axis is space and y axis is time.</p>
<p><a id='Produce-field-U-(Kuramoto-Sivashinsky)-1'></a></p>
<h3 id="produce-field-u-kuramoto-sivashinsky">Produce field U (Kuramoto Sivashinsky)</h3>
<p>```@example stexamples
using PyPlot
using TimeseriesPrediction</p>
<p>testdir = dirname(dirname(pathof(TimeseriesPrediction)))<em>"/test"
@assert isdir(testdir)
include(testdir</em>"/ks_solver.jl")</p>
<p>Ntrain = 10000
p = 100
N = Ntrain + p</p>
<p>U, T = KuramotoSivashinsky(64, 22, N÷4, 0.25)
summary(U)</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">&#39;Temporal-prediction-of-field-U-1&#39;</span><span class="nt">&gt;&lt;/a&gt;</span>

### Temporal prediction of field U


```@example stexamples
Q = length(U[1]) # spatial length
pool = U[1:Ntrain]
test = U[Ntrain:N]

D = 10
τ = 1
B = 10
k = 1
ntype = FixedMassNeighborhood(4)
method = AverageLocalModel()

em = cubic_shell_embedding(pool, D,τ,B,k,PeriodicBoundary())
pcaem= PCAEmbedding(pool,em)

@time pred = temporalprediction(pool,pcaem, p;ntype=ntype, method=method, progress = false)

err = [abs.(test[i]-pred[i]) for i=1:p+1]
println(&quot;Maximum error: &quot;, maximum(maximum(e) for e in err))
</pre></div>


<p><a id='Plot-the-result-1'></a></p>
<h3 id="plot-the-result">Plot the result</h3>
<p>Deduce field extremal values</p>
<div class="codehilite"><pre><span></span><span class="n">vmax</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">maximum</span><span class="p">(</span><span class="n">maximum</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="kp">in</span> <span class="n">test</span><span class="p">),</span>
           <span class="n">maximum</span><span class="p">(</span><span class="n">maximum</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="kp">in</span> <span class="n">pred</span><span class="p">))</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">minimum</span><span class="p">(</span><span class="n">minimum</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="kp">in</span> <span class="n">test</span><span class="p">),</span>
           <span class="n">minimum</span><span class="p">(</span><span class="n">minimum</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="kp">in</span> <span class="n">pred</span><span class="p">))</span>
</pre></div>


<p>Transform data for imshow</p>
<p>```@example stexamples
ptest = cat(test..., dims = 2)
ppred = cat(pred..., dims = 2)
perr = cat(err..., dims = 2)</p>
<div class="codehilite"><pre><span></span>plot plot plot


```@example stexamples
fig = figure(figsize=(8,8))
ax1 = subplot2grid((3,1), (0,0))
ax2 = subplot2grid((3,1), (1,0))
ax3 = subplot2grid((3,1), (2,0));

im1 = ax1[:imshow](ppred, cmap=&quot;viridis&quot;, vmin = vmin, vmax = vmax,
aspect = &quot;auto&quot;, extent = (T[Ntrain], T[N], 1, Q))
im2 = ax2[:imshow](ptest, cmap=&quot;viridis&quot;, vmin = vmin, vmax = vmax,
aspect = &quot;auto&quot;, extent = (T[Ntrain], T[N], 1, Q))
im3 = ax3[:imshow](perr, cmap=&quot;inferno&quot;, vmin = 0, vmax = vmax-vmin,
aspect = &quot;auto&quot;, extent = (T[Ntrain], T[N], 1, Q))

for (j, (im, ax)) in enumerate(zip([im1,im2,im3], [ax1,ax2,ax3]))
    colorbar(im, ax = ax, fraction=0.04, pad=0.01)# format=&quot;%.1f&quot;)
    if j &lt; 3
        ax[:set_xticklabels]([])
    end
end
ax1[:set_title](&quot;Prediction&quot;)
ax2[:set_title](&quot;Real evolution&quot;)
ax3[:set_title](&quot;Absolute error&quot;)

ax2[:set_ylabel](&quot;space&quot;)
ax3[:set_xlabel](&quot;time&quot;)
tight_layout(w_pad=0.1, h_pad=0.00001)
savefig(&quot;ksprediction.png&quot;); nothing # hide
</pre></div>


<p><img alt="ksprediction" src="../ksprediction.png" /></p>
<p><a id='Cross-Prediction:-Barkley-Model-1'></a></p>
<h2 id="cross-prediction-barkley-model">Cross Prediction: Barkley Model</h2>
<p>This example cross-predicts a field U from a field V. Both fields have to be represented as vectors of matrices. Where the fields come from does not matter, but to make the example runnable we load one of the test systems of TimeseriesPrediction.</p>
<p>This example uses cubic shell embedding and a linear Barkley model.</p>
<p>Importantly, the results are compared with the "real" evolution of the system.</p>
<p><a id='Simulate-a-test-system-1'></a></p>
<h3 id="simulate-a-test-system">Simulate a test system</h3>
<p>```@example stexamples
using PyPlot
using TimeseriesPrediction</p>
<p>testdir = dirname(dirname(pathof(TimeseriesPrediction)))<em>"/test"
@assert isdir(testdir)
include(testdir</em>"/system_defs.jl")</p>
<p>Ttrain = 500
Ttest = 10
T = Ttrain + Ttest</p>
<p>U, V = barkley(T;tskip=100, size=(50,50), periodic = false)
summary(U)</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">&#39;Cross-predict-field-U-from-field-V-1&#39;</span><span class="nt">&gt;&lt;/a&gt;</span>

### Cross predict field U from field V


```@example stexamples
D = 5
τ = 1
B = 1
k = 1
bc = PeriodicBoundary()

source_train = V[1: Ttrain]
target_train = U[1: Ttrain]
source_pred  = V[Ttrain  - D*τ + 1:  T]
target_test  = U[Ttrain        + 1:  T]

em = cubic_shell_embedding(source_train, D,τ,B,k,bc)
pcaem = PCAEmbedding(source_train, em; maxoutdim=5) # PCA speeds things up!

@time target_pred = crossprediction(source_train, target_train, source_pred, em;
progress = false)

err = [abs.(target_test[i]-target_pred[i]) for i=1:Ttest]

println(&quot;Maximum error: &quot;, maximum(maximum(e) for e in err))
</pre></div>


<p><a id='Plot-prediction-1'></a></p>
<h3 id="plot-prediction">Plot prediction</h3>
<p>Deduce field extremal values</p>
<div class="codehilite"><pre><span></span><span class="n">source_max</span> <span class="o">=</span> <span class="n">maximum</span><span class="p">(</span><span class="n">maximum</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="kp">in</span> <span class="n">source_pred</span><span class="p">)</span>
<span class="n">target_max</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">maximum</span><span class="p">(</span><span class="n">maximum</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="kp">in</span> <span class="n">target_test</span><span class="p">),</span>
                 <span class="n">maximum</span><span class="p">(</span><span class="n">maximum</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="kp">in</span> <span class="n">target_pred</span><span class="p">))</span>
<span class="n">source_min</span> <span class="o">=</span> <span class="n">minimum</span><span class="p">(</span><span class="n">minimum</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="kp">in</span> <span class="n">source_pred</span><span class="p">)</span>
<span class="n">target_min</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">minimum</span><span class="p">(</span><span class="n">minimum</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="kp">in</span> <span class="n">target_test</span><span class="p">),</span>
                 <span class="n">minimum</span><span class="p">(</span><span class="n">minimum</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="kp">in</span> <span class="n">target_pred</span><span class="p">))</span>
</pre></div>


<p>Plot various predicted frames (only the last one shown here)</p>
<p>```@example stexamples
for i in [1, length(err)÷2, length(err)]</p>
<div class="codehilite"><pre><span></span>fig = figure(figsize=(10,10))
ax1 = subplot2grid((2,2), (0,0))
ax2 = subplot2grid((2,2), (0,1))
ax3 = subplot2grid((2,2), (1,0))
ax4 = subplot2grid((2,2), (1,1))
im1 = ax1[:imshow](source_pred[i], cmap=&quot;viridis&quot;, vmin = source_min, vmax = source_max)
im2 = ax2[:imshow](target_test[i], cmap=&quot;cividis&quot;, vmin = target_min, vmax = target_max)
im3 = ax3[:imshow](target_pred[i], cmap=&quot;cividis&quot;, vmin = target_min, vmax = target_max)
im4 = ax4[:imshow](err[i], cmap=&quot;inferno&quot;, vmin = 0, vmax = target_max - target_min)
for (im, ax) in zip([im1,im2,im3,im4], [ax1,ax2,ax3,ax4])
    ax[:get_xaxis]()[:set_ticks]([])
    ax[:get_yaxis]()[:set_ticks]([])
    colorbar(im, ax = ax, fraction=0.046, pad=0.04)#, format=&quot;%.1f&quot;)
end
ax1[:set_title](&quot;Source&quot;)
ax2[:set_title](&quot;Target Test&quot;)
ax3[:set_title](&quot;Target Cross-Pred.&quot;)
ax4[:set_title](&quot;absolute error&quot;)
tight_layout(w_pad=0.6, h_pad=0.00001)
suptitle(&quot;frame $i&quot;)
</pre></div>


<p>end
savefig("barkley_cross.png"); nothing # hide</p>
<div class="codehilite"><pre><span></span><span class="p">![</span><span class="s s-Atom">barkley_cross</span><span class="p">](</span><span class="s s-Atom">barkley_cross</span><span class="p">.</span><span class="s s-Atom">png</span><span class="p">)</span>


<span class="o">&lt;</span><span class="s s-Atom">a</span> <span class="s s-Atom">id=&#39;Temporal-Prediction:-Periodic-Nonlinear-Barkley-Model-1&#39;&gt;&lt;/a</span><span class="o">&gt;</span>

<span class="c1">## Temporal Prediction: Periodic Nonlinear Barkley Model</span>


<span class="nv">This</span> <span class="s s-Atom">example</span> <span class="s s-Atom">predicts</span> <span class="s s-Atom">the</span> <span class="s s-Atom">temporal</span> <span class="s s-Atom">evolution</span> <span class="s s-Atom">of</span> <span class="s s-Atom">a</span> <span class="s s-Atom">field</span> <span class="nv">U</span><span class="p">,</span> <span class="s s-Atom">which</span> <span class="s s-Atom">has</span> <span class="s s-Atom">to</span> <span class="s s-Atom">be</span> <span class="s s-Atom">represented</span> <span class="s s-Atom">as</span> <span class="s s-Atom">vectors</span> <span class="s s-Atom">of</span> <span class="s s-Atom">matrices</span><span class="p">.</span> <span class="nv">Where</span> <span class="s s-Atom">the</span> <span class="s s-Atom">field</span> <span class="s s-Atom">comes</span> <span class="s s-Atom">from</span> <span class="s s-Atom">does</span> <span class="o">not</span> <span class="s s-Atom">matter</span><span class="p">,</span> <span class="s s-Atom">but</span> <span class="s s-Atom">to</span> <span class="s s-Atom">make</span> <span class="s s-Atom">the</span> <span class="s s-Atom">example</span> <span class="s s-Atom">runnable</span> <span class="s s-Atom">we</span> <span class="s s-Atom">load</span> <span class="s s-Atom">one</span> <span class="s s-Atom">of</span> <span class="s s-Atom">the</span> <span class="s s-Atom">test</span> <span class="s s-Atom">systems</span> <span class="s s-Atom">of</span> <span class="nv">TimeseriesPrediction</span><span class="p">.</span>


<span class="nv">This</span> <span class="s s-Atom">example</span> <span class="s s-Atom">uses</span> <span class="s s-Atom">light</span> <span class="s s-Atom">cone</span> <span class="s s-Atom">embedding</span> <span class="s s-Atom">and</span> <span class="s s-Atom">a</span> <span class="s s-Atom">nonlinear</span> <span class="nv">Barkley</span> <span class="s s-Atom">model</span><span class="p">.</span>


<span class="nv">Importantly</span><span class="p">,</span> <span class="s s-Atom">the</span> <span class="s s-Atom">results</span> <span class="s s-Atom">are</span> <span class="s s-Atom">compared</span> <span class="s s-Atom">with</span> <span class="s s-Atom">the</span> <span class="s2">&quot;real&quot;</span> <span class="s s-Atom">evolution</span> <span class="s s-Atom">of</span> <span class="s s-Atom">the</span> <span class="s s-Atom">system</span><span class="p">.</span>


<span class="o">&lt;</span><span class="s s-Atom">a</span> <span class="s s-Atom">id=&#39;Simulate-a-test-system-2&#39;&gt;&lt;/a</span><span class="o">&gt;</span>

<span class="c1">### Simulate a test system</span>


<span class="err">```</span><span class="s s-Atom">@example</span> <span class="s s-Atom">stexamples</span>
<span class="s s-Atom">using</span> <span class="nv">PyPlot</span>
<span class="s s-Atom">using</span> <span class="nv">TimeseriesPrediction</span>

<span class="s s-Atom">testdir</span> <span class="o">=</span> <span class="nf">dirname</span><span class="p">(</span><span class="nf">dirname</span><span class="p">(</span><span class="nf">pathof</span><span class="p">(</span><span class="nv">TimeseriesPrediction</span><span class="p">)))</span><span class="s s-Atom">*</span><span class="s2">&quot;/test&quot;</span>
<span class="s s-Atom">@assert</span> <span class="nf">isdir</span><span class="p">(</span><span class="s s-Atom">testdir</span><span class="p">)</span>
<span class="nf">include</span><span class="p">(</span><span class="s s-Atom">testdir*</span><span class="s2">&quot;/system_defs.jl&quot;</span><span class="p">)</span>

<span class="nv">Ttrain</span> <span class="o">=</span> <span class="mi">600</span>
<span class="nv">Ttest</span> <span class="o">=</span> <span class="mi">10</span>
<span class="nv">T</span> <span class="o">=</span> <span class="nv">Tskip</span> <span class="o">+</span> <span class="nv">Ttrain</span> <span class="o">+</span> <span class="nv">Ttest</span>

<span class="nv">U</span><span class="p">,</span> <span class="nv">V</span> <span class="o">=</span> <span class="nf">barkley</span><span class="p">(</span><span class="nv">T</span><span class="p">;</span> <span class="s s-Atom">tskip</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="s s-Atom">size=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">))</span>
<span class="nf">summary</span><span class="p">(</span><span class="nv">U</span><span class="p">)</span>
</pre></div>


<p><a id='Temporal-prediction-of-field-U-2'></a></p>
<h3 id="temporal-prediction-of-field-u">Temporal prediction of field U</h3>
<p>```@example stexamples
D = 2
τ = 1
r₀ = 1
c = 1
bc = PeriodicBoundary()</p>
<p>pool = U[1 : Ttrain]
test  = U[ Ttrain : T]</p>
<p>em = light_cone_embedding(pool, D,τ,r₀,c,bc)
pcaem = PCAEmbedding(pool, em; maxoutdim=5) # PCA speeds things up!</p>
<p>@time pred = temporalprediction(pool, em, Ttest; progress = false)</p>
<p>err = [abs.(test[i]-pred[i]) for i=1:Ttest+1]</p>
<p>println("Maximum error: ", maximum(maximum(e) for e in err))</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">&#39;Plot-prediction-2&#39;</span><span class="nt">&gt;&lt;/a&gt;</span>

### Plot prediction


Deduce field maximum values


```julia
vmax = max(maximum(maximum(s) for s in test),
           maximum(maximum(s) for s in pred))
vmin = min(minimum(minimum(s) for s in test),
           minimum(minimum(s) for s in pred))
</pre></div>


<p>plot plot plot</p>
<p>```@example stexamples
for i in [1, length(err)÷2, length(err)]</p>
<div class="codehilite"><pre><span></span>fig = figure(figsize=(10,3))
ax1 = subplot2grid((1,3), (0,0))
ax2 = subplot2grid((1,3), (0,1))
ax3 = subplot2grid((1,3), (0,2))

im1 = ax1[:imshow](pred[i], cmap=&quot;viridis&quot;, vmin = vmin, vmax = vmax)
im2 = ax2[:imshow](test[i], cmap=&quot;viridis&quot;, vmin = vmin, vmax = vmax)
im3 = ax3[:imshow](err[i], cmap=&quot;inferno&quot;, vmin = 0, vmax = vmax-vmin)
for (im, ax) in zip([im1,im2,im3], [ax1,ax2,ax3])
    ax[:get_xaxis]()[:set_ticks]([])
    ax[:get_yaxis]()[:set_ticks]([])
    colorbar(im, ax = ax, fraction=0.046, pad=0.04)#, format=&quot;%.1f&quot;)
end
ax1[:set_title](&quot;Prediction&quot;)
ax2[:set_title](&quot;Real evolution&quot;)
ax3[:set_title](&quot;Absolute error&quot;)
suptitle(&quot;frame $i&quot;)
tight_layout(w_pad=0.6, h_pad=0.00001)
subplots_adjust(top=0.75)
</pre></div>


<p>end
savefig("barkley_tempo.png"); nothing # hide
```</p>
<p><img alt="barkley_tempo" src="../barkley_tempo.png" /></p>
<p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../spatiotemporal/" title="Spatio-Temporal Prediction" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Spatio-Temporal Prediction
              </span>
            </div>
          </a>
        
        
          <a href="../../advanced/" title="Advanced Documentation" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Advanced Documentation
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/JuliaDynamics/DynamicalSystems.jl" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.30f6b8b1.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
        <script src="../../assets\mathjaxhelper.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
    
  </body>
</html>